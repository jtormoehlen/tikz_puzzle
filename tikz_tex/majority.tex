\begin{tikzpicture}

    \node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect1) at (0,0) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
else:
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
0
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect2) at (rect1.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
count_left = sum(1 for i in range(left, right + 1) if numbers[i] == maj_left)
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
1
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect3) at (rect2.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
count_right = sum(1 for i in range(left, right + 1) if numbers[i] == maj_right)
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
2
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect4) at (rect3.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
return None
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
3
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect5) at (rect4.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
elif count_right > (right - left + 1) // 2:
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
4
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect6) at (rect5.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
return numbers[left] 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
5a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect601) at (rect6.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 return None
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
5b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect7) at (rect6.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
mid = (left + right) // 2
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
6
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect8) at (rect7.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
def maj_elem(numbers, left, right):
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
7
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect9) at (rect8.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
return maj_left 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
8a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect901) at (rect9.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 return None
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
8b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect10) at (rect9.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
if left == right: 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
9a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect1001) at (rect10.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 if left >= right:
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
9b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect11) at (rect10.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
maj_right = maj_elem(numbers, mid + 1, right) 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
10a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect1101) at (rect11.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 maj_elem(numbers, mid + 1, right)
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
10b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect12) at (rect11.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
return maj_right
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
11
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect13) at (rect12.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
if maj_left == maj_right: 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
12a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect1301) at (rect13.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 if maj_left != maj_right:
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
12b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect14) at (rect13.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
if count_left > (right - left + 1) // 2:
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
13
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect15) at (rect14.south west) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
maj_left = maj_elem(numbers, left, mid) 
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
14a
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=0.5*\rectWidth, minimum height=\rectHeight, anchor=west] (rect1501) at (rect15.east) {
\begin{minipage}[c]{6.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
 maj_elem(numbers, left, mid)
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
14b
\end{minipage}
};\node[draw, rounded corners, fill=lightgray!20, minimum width=1*\rectWidth, minimum height=\rectHeight, anchor=north west] (rect16) at (rect15.south west) {
\begin{minipage}[c]{14.5cm}
\begin{lstlisting}[language=Python, breaklines=true]
return maj_left
\end{lstlisting}
\end{minipage}
\begin{minipage}[c]{0.5cm}
15
\end{minipage}
};

    \end{tikzpicture}
